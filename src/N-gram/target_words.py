from pathlib import Path
from collections import Counter

# Expandable Bangla stopwords set
bangla_stopwords = set([
    'অতএব', 'অথচ', 'অথবা', 'অনুযায়ী', 'অনেক', 'অনেকে', 'অন্তত', 'অন্য', 'অবধি', 'অবশ্য', 'অর্থাৎ',
    'আই', 'আছে', 'আজ', 'আপনার', 'আপনি', 'আবার', 'আমরা', 'আমাকে', 'আমাদের', 'আমার', 'আমি',
    'আর', 'আরও', 'ই', 'ইত্যাদি', 'এই', 'এ', 'এঁদের', 'এঁরা', 'এটি', 'এটা', 'এটা', 'এদিকে', 'এবং', 'এবার',
    'এমন', 'এমনকী', 'এরা', 'এল', 'এস', 'এসে', 'ঐ', 'ও', 'ওই', 'ওদের', 'ওর', 'কখনও', 'কত', 'কবে',
    'কমনে', 'কয়েক', 'করবে', 'করবেন', 'করল', 'করলেন', 'করা', 'করানো', 'করায়', 'করার', 'করি', 'করেছে',
    'করেন', 'করে', 'করেই', 'করেনি', 'কিছু', 'কিছুই', 'কিন্তু', 'কী', 'কেউ', 'কে', 'কেমন', 'কোথা', 'কোন',
    'কোনও', 'কি', 'কিভাবে', 'কিছুক্ষণ', 'কেন', 'কেউই', 'গিয়ে', 'গিয়েছে', 'গেল', 'গেলে', 'চলে', 'ছাড়া',
    'ছিল', 'ছিলাম', 'ছিলেন', 'ছিলো', 'জানেন', 'জন্য', 'জানে', 'জানানো', 'জানায়', 'জানিয়ে', 'টা',
    'টি', 'তখন', 'তত', 'তবে', 'তুমি', 'তুলে', 'তেমন', 'তো', 'তোমার', 'তাদের', 'তাহলে', 'তা', 'তাঁদের',
    'তাঁরা', 'তাঁর', 'তাঁরা', 'তাঁকে', 'তাঁরাও', 'তাদেরকে', 'তারা', 'তার', 'তারা', 'তাকে', 'তাহা', 'তিন',
    'তিনি', 'তিনিও', 'তুমি', 'তোমরা', 'থাকবে', 'থাকবেন', 'থাকা', 'থাকায়', 'থাকে', 'থেকেও', 'থেকে',
    'দিকে', 'দিয়ে', 'দিলেন', 'দিতে', 'দিয়ে', 'দুজন', 'দুটি', 'দুটো', 'দেওয়া', 'দেওয়া হয়', 'দেন', 'দেননি',
    'ধরে', 'ধরে', 'নই', 'নয়', 'না', 'নিতে', 'নিজে', 'নিজেই', 'নিজের', 'নিজেদের', 'নেওয়া', 'নেওয়া হয়নি',
    'নেওয়ার', 'নিয়েই', 'নিয়েছে', 'নিয়েছেন', 'নিয়ে', 'নেই', 'পক্ষে', 'পর', 'পরেও', 'পর্যন্ত', 'পরে', 'পাওয়া',
    'পারে', 'পারেন', 'পারি', 'পি', 'পেয়েছি', 'প্রতি', 'প্রভৃতি', 'ফিরে', 'বদলে', 'বরং', 'বললেন', 'বললেন না',
    'বললাম', 'বলতে', 'বলল', 'বললেন', 'বলছি', 'বলেছেন', 'বলে', 'বলেন', 'বলা', 'বলে', 'বসে', 'বা', 'বিনা',
    'বিশেষ', 'ব্যবহার', 'ব্যবহার করে', 'ভাল', 'ভাবেই', 'মতো', 'মধ্যেও', 'মধ্যেই', 'মাধ্যমে', 'মোট', 'যখন',
    'যত', 'যথেষ্ট', 'যদি', 'যাবে', 'যাওয়া', 'যাচ্ছে', 'যাতে', 'যার', 'যারা', 'যিনি', 'যে', 'যেকোনো', 'যেখানে',
    'যেমন', 'যেতে', 'যেন', 'যেহেতু', 'যেয়ে', 'র', 'রকম', 'রেখে', 'রয়েছে', 'শুধু', 'সঙ্গে', 'সব', 'সবার',
    'সবাই', 'সমস্ত', 'সম্পর্কে', 'সহ', 'সবারই', 'সামনে', 'সি', 'সে', 'সেই', 'সেখান', 'সেখানে', 'স্পষ্ট',
    'হইতে', 'হইবে', 'হইয়াছে', 'হইয়েছে', 'হওয়া', 'হওয়াতে', 'হওয়ার', 'হওয়ায়', 'হচ্ছে', 'হত', 'হতে',
    'হবেন', 'হয়ে', 'হয়', 'হয়তো', 'হয়নি', 'হয়েছে', 'হয়েছে', 'হল', 'হলে', 'হলো', 'হিসেবে', 'এক', 'থে', 'আমা',
    'যা', 'হা', 'তাঁ', 'করেছেন', 'ঢাকা', 'বাংলাদেশ', 'ভারত', 'হয়েছে', 'জানা','গেছে', 'দেওয়া','কাজ','জানান', 'হবে', 'দি','রয়েছে',
    'শুরু','প্রা','দেখ','নি','একটু','মধ্যে','কথা','হঠাৎ','তোমা','উঠল','যায়','আমর','ওদ','দেখি','তে','উপর','নাম','এর','শুনে','কিন্ত','খুব',
    'বেশ','থা','জন্যে','এখন','গলায়','ঠিক','কোনো','বাড়ি','একজন','হাত','তাকিয়ে','পার','আচ্ছা','দিন','করছে','খালা','জানি',
    'মুখ','কোথায়','আছেন','তাই','বুঝ','শেষ','উঠে','চেষ্','ফেলে','দেব','এখনো','খেয়ে','যাব','রা','দু',
    "অতএব","অথচ","অথবা","অনুযায়ী","অনেক","অনেকে","অনেকেই","অন্তত","অন্য","অবধি","অবশ্য","অর্থাত","আই","আগামী","আগে","আগেই",
    "আছে","আজ","আদ্যভাগে","আপনার","আপনি","আবার","আমরা","আমাকে","আমাদের","আমার","আমি","আর","আরও","ই","ইত্যাদি","ইহা","উচিত",
    "উত্তর","উনি","উপর","উপরে","এ","এঁদের","এঁরা","এই","একই","একটি","একবার","একে","এক্","এখন","এখনও","এখানে","এখানেই","এটা","এটাই",
    "এটি","এত","এতটাই","এতে","এদের","এব","এবং","এবার","এমন","এমনকী","এমনি","এর","এরা","এল","এস","এসে","ঐ","ও","ওঁদের","ওঁর","ওঁরা",
    "ওই","ওকে","ওখানে","ওদের","ওর","ওরা","কখনও","কত","কবে","কমনে","কয়েক","কয়েকটি","করছে","করছেন","করতে","করবে","করবেন","করলে",
    "করলেন","করা","করাই","করায়","করার","করি","করিতে","করিয়া","করিয়ে","করে","করেই","করেছিলেন","করেছে","করেছেন","করেন","কাউকে","কাছ","কাছে",
    "কাজ","কাজে","কারও","কারণ","কি","কিংবা","কিছু","কিছুই","কিন্তু","কী","কে","কেউ","কেউই","কেখা","কেন","কোটি","কোন","কোনও","কোনো","ক্ষেত্রে","কয়েক",
    "খুব","গিয়ে","গিয়েছে","গিয়ে","গুলি","গেছে","গেল","গেলে","গোটা","চলে","চান","চায়","চার","চালু","চেয়ে","চেষ্টা","ছাড়া","ছাড়াও","ছিল","ছিলেন","জন","জনকে",
    "জনের","জন্য","জন্যওজে","জানতে","জানা","জানানো","জানায়","জানিয়ে","জানিয়েছে","জে","জ্নজন","টি","ঠিক","তখন","তত","তথা","তবু","তবে","তা","তাঁকে",
    "তাঁদের","তাঁর","তাঁরা","তাঁাহারা","তাই","তাও","তাকে","তাতে","তাদের","তার","তারপর","তারা","তারৈ","তাহলে","তাহা","তাহাতে","তাহার","তিনঐ","তিনি","তিনিও","তুমি",
    "তুলে","তেমন","তো","তোমার","থাকবে","থাকবেন","থাকা","থাকায়","থাকে","থাকেন","থেকে","থেকেই","থেকেও","দিকে","দিতে","দিন","দিয়ে","দিয়েছে","দিয়েছেন","দিলেন",
    "দু","দুই","দুটি","দুটো","দেওয়া","দেওয়ার","দেওয়া","দেখতে","দেখা","দেখে","দেন","দেয়","দ্বারা","ধরা","ধরে","ধামার","নতুন","নয়","না","নাই","নাকি","নাগাদ","নানা","নিজে",
    "নিজেই","নিজেদের","নিজের","নিতে","নিয়ে","নিয়ে","নেই","নেওয়া","নেওয়ার","নেওয়া","নয়","পক্ষে","পর","পরে","পরেই","পরেও","পর্যন্ত","পাওয়া","পাচ","পারি","পারে","পারেন",
    "পি","পেয়ে","পেয়্র্","প্রতি","প্রথম","প্রভৃতি","প্রযন্ত","প্রাথমিক","প্রায়","প্রায়","ফলে","ফিরে","ফের","বক্তব্য","বদলে","বন","বরং","বলতে","বলল","বললেন","বলা","বলে","বলেছেন",
    "বলেন","বসে","বহু","বা","বাদে","বার","বি","বিনা","বিভিন্ন","বিশেষ","বিষয়টি","বেশ","বেশি","ব্যবহার","ব্যাপারে","ভাবে","ভাবেই","মতো","মতোই","মধ্যভাগে","মধ্যে","মধ্যেই","মধ্যেও",
    "মনে","মাত্র","মাধ্যমে","মোট","মোটেই","যখন","যত","যতটা","যথেষ্ট","যদি","যদিও","যা","যাঁর","যাঁরা","যাওয়া","যাওয়ার","যাওয়া","যাকে","যাচ্ছে","যাতে","যাদের","যান","যাবে","যায়",
    "যার","যারা","যিনি","যে","যেখানে","যেতে","যেন","যেমন","র","রকম","রয়েছে","রাখা","রেখে","লক্ষ","শুধু","শুরু","সঙ্গে","সঙ্গেও","সব","সবার","সমস্ত","সম্প্রতি","সহ","সহিত","সাধারণ",
    "সামনে","সি","সুতরাং","সে","সেই","সেখান","সেখানে","সেটা","সেটাই","সেটাও","সেটি","স্পষ্ট","স্বয়ং","হইতে","হইবে","হইয়া","হওয়া","হওয়ায়","হওয়ার","হচ্ছে","হত","হতে","হতেই","হন","হবে",
    "হবেন","হয়","হয়তো","হয়নি","হয়ে","হয়েই","হয়েছিল","হয়েছে","হয়েছেন","হল","হলে","হলেই","হলেও","হলো","হাজার","হিসাবে","হৈলে","হোক","হয়","একটা",
    "একট","হয়ে","আছে৷","তুই","না৷","যাই","জি","রূপা","ফুপা","সাহেব","হিমু","আপনাকে","বের","মানুষ","দিয়ে","যায়"
])

def main():
    # Set input/output paths relative to this script's grandparent (project root)
    input_root = Path(__file__).resolve().parents[2] / "data_cleaned"
    output_root = Path(__file__).resolve().parents[2] / "results"
    output_root.mkdir(parents=True, exist_ok=True)

    for file_path in input_root.glob("*.txt"):
        period = file_path.stem  # e.g., "1950_1970"
        with open(file_path, "r", encoding="utf-8") as f:
            raw_text = f.read()
        
        # If already tokenized, just split and filter stopwords
        tokens = [t for t in raw_text.replace("<s>", " ").split() if t not in bangla_stopwords]
        freq_dist = Counter(tokens)
        top_100 = freq_dist.most_common(100)

        output_file = output_root / f"top_words_{period}.txt"
        with open(output_file, "w", encoding="utf-8") as f_out:
            for word, count in top_100:
                f_out.write(f"{word}\t{count}\n")

if __name__ == "__main__":
    main()
